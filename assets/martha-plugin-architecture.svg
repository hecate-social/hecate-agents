<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 820" font-family="monospace" font-size="13">
  <defs>
    <marker id="arrow" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 z" fill="#94a3b8"/>
    </marker>
    <marker id="arrow-indigo" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 z" fill="#818cf8"/>
    </marker>
    <marker id="arrow-rose" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 z" fill="#fb7185"/>
    </marker>
    <marker id="arrow-amber" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 z" fill="#fbbf24"/>
    </marker>
    <marker id="arrow-teal" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 z" fill="#2dd4bf"/>
    </marker>
    <marker id="arrow-purple" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 z" fill="#a78bfa"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1000" height="820" fill="#0f1117" rx="8"/>

  <!-- Title -->
  <text x="500" y="30" fill="#e2e8f0" font-size="18" font-weight="bold" text-anchor="middle">Martha Plugin Architecture</text>
  <text x="500" y="48" fill="#64748b" font-size="11" text-anchor="middle">hecate-marthaw (frontend) + hecate-marthad (daemon) connected via Unix socket</text>

  <!-- ========== COLUMN 1: FRONTEND (hecate-marthaw) ========== -->
  <rect x="20" y="65" width="280" height="530" rx="6" fill="#1e1b3a" stroke="#6366f1" stroke-width="2"/>
  <text x="160" y="88" fill="#a5b4fc" font-size="14" font-weight="bold" text-anchor="middle">hecate-marthaw</text>
  <text x="160" y="104" fill="#6366f1" font-size="10" text-anchor="middle">SvelteKit Frontend (Svelte 5)</text>

  <!-- MarthaStudio.svelte -->
  <rect x="35" y="115" width="250" height="32" rx="4" fill="#312e81" stroke="#818cf8" stroke-width="1.5"/>
  <text x="160" y="136" fill="#c7d2fe" font-size="12" font-weight="bold" text-anchor="middle">MarthaStudio.svelte</text>

  <!-- Venture-level slices (blue) -->
  <text x="40" y="166" fill="#818cf8" font-size="10" font-weight="bold">Venture Slices</text>
  <rect x="35" y="172" width="250" height="24" rx="3" fill="#1e1b4b" stroke="#6366f1" stroke-width="1"/>
  <text x="160" y="189" fill="#a5b4fc" font-size="10" text-anchor="middle">compose_vision/</text>
  <rect x="35" y="200" width="250" height="24" rx="3" fill="#1e1b4b" stroke="#6366f1" stroke-width="1"/>
  <text x="160" y="217" fill="#a5b4fc" font-size="10" text-anchor="middle">brainstorm_venture_events/</text>
  <rect x="35" y="228" width="250" height="24" rx="3" fill="#1e1b4b" stroke="#6366f1" stroke-width="1"/>
  <text x="160" y="245" fill="#a5b4fc" font-size="10" text-anchor="middle">storm_venture_big_picture/</text>

  <!-- Division ALC slices (green) -->
  <text x="40" y="272" fill="#4ade80" font-size="10" font-weight="bold">Division ALC Slices</text>
  <rect x="35" y="278" width="250" height="24" rx="3" fill="#052e16" stroke="#22c55e" stroke-width="1"/>
  <text x="160" y="295" fill="#86efac" font-size="10" text-anchor="middle">design_division/</text>
  <rect x="35" y="306" width="250" height="24" rx="3" fill="#052e16" stroke="#22c55e" stroke-width="1"/>
  <text x="160" y="323" fill="#86efac" font-size="10" text-anchor="middle">plan_division/</text>
  <rect x="35" y="334" width="250" height="24" rx="3" fill="#052e16" stroke="#22c55e" stroke-width="1"/>
  <text x="160" y="351" fill="#86efac" font-size="10" text-anchor="middle">craft_division/</text>
  <rect x="35" y="362" width="250" height="24" rx="3" fill="#052e16" stroke="#22c55e" stroke-width="1"/>
  <text x="160" y="379" fill="#86efac" font-size="10" text-anchor="middle">deploy_division/</text>

  <!-- Future slices (purple) -->
  <text x="40" y="406" fill="#c084fc" font-size="10" font-weight="bold">Future Slices</text>
  <rect x="35" y="412" width="120" height="22" rx="3" fill="#2e1065" stroke="#a855f7" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="95" y="427" fill="#d8b4fe" font-size="9" text-anchor="middle">refactor_div/</text>
  <rect x="165" y="412" width="120" height="22" rx="3" fill="#2e1065" stroke="#a855f7" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="225" y="427" fill="#d8b4fe" font-size="9" text-anchor="middle">debug_div/</text>
  <rect x="35" y="438" width="120" height="22" rx="3" fill="#2e1065" stroke="#a855f7" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="95" y="453" fill="#d8b4fe" font-size="9" text-anchor="middle">monitor_div/</text>
  <rect x="165" y="438" width="120" height="22" rx="3" fill="#2e1065" stroke="#a855f7" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="225" y="453" fill="#d8b4fe" font-size="9" text-anchor="middle">rescue_div/</text>

  <!-- Shared + guide_venture (gray) -->
  <text x="40" y="480" fill="#9ca3af" font-size="10" font-weight="bold">Shared</text>
  <rect x="35" y="486" width="120" height="22" rx="3" fill="#1f2937" stroke="#6b7280" stroke-width="1"/>
  <text x="95" y="501" fill="#d1d5db" font-size="9" text-anchor="middle">guide_venture/</text>
  <rect x="165" y="486" width="120" height="22" rx="3" fill="#1f2937" stroke="#6b7280" stroke-width="1"/>
  <text x="225" y="501" fill="#d1d5db" font-size="9" text-anchor="middle">shared/</text>

  <!-- Shared components detail -->
  <text x="40" y="528" fill="#64748b" font-size="9">TaskCard, AIAssistPanel,</text>
  <text x="40" y="540" fill="#64748b" font-size="9">EventStreamViewer, PhaseProgress</text>

  <!-- Each slice contents -->
  <text x="40" y="563" fill="#475569" font-size="9">Each slice: Component.svelte +</text>
  <text x="40" y="575" fill="#475569" font-size="9">store.ts + types.ts</text>

  <!-- ========== COLUMN 2: UNIX SOCKET ========== -->
  <rect x="315" y="150" width="80" height="380" rx="4" fill="#1c1917" stroke="#78716c" stroke-width="1.5"/>
  <text x="355" y="175" fill="#d6d3d1" font-size="11" font-weight="bold" text-anchor="middle" transform="rotate(-90,355,175)">Unix Socket</text>

  <!-- Socket label -->
  <rect x="318" y="310" width="74" height="44" rx="3" fill="#292524" stroke="#a8a29e" stroke-width="1"/>
  <text x="355" y="328" fill="#e7e5e4" font-size="9" font-weight="bold" text-anchor="middle">api.sock</text>
  <text x="355" y="342" fill="#78716c" font-size="8" text-anchor="middle">bidirectional</text>

  <!-- Bidirectional arrows -->
  <line x1="300" y1="320" x2="318" y2="320" stroke="#818cf8" stroke-width="2" marker-end="url(#arrow-indigo)"/>
  <line x1="392" y1="320" x2="300" y2="320" stroke="#818cf8" stroke-width="0" />
  <line x1="318" y1="340" x2="300" y2="340" stroke="#818cf8" stroke-width="2" marker-end="url(#arrow-indigo)"/>
  <line x1="392" y1="340" x2="410" y2="340" stroke="#818cf8" stroke-width="2" marker-end="url(#arrow-indigo)"/>
  <line x1="410" y1="320" x2="392" y2="320" stroke="#fb7185" stroke-width="2" marker-end="url(#arrow-rose)"/>

  <!-- ========== COLUMN 3: DAEMON (hecate-marthad) ========== -->
  <rect x="410" y="65" width="570" height="530" rx="6" fill="#1a0a0e" stroke="#f43f5e" stroke-width="2"/>
  <text x="695" y="88" fill="#fda4af" font-size="14" font-weight="bold" text-anchor="middle">hecate-marthad</text>
  <text x="695" y="104" fill="#fb7185" font-size="10" text-anchor="middle">Erlang/OTP Daemon (Podman Container)</text>

  <!-- Cowboy handler -->
  <rect x="425" y="115" width="185" height="32" rx="4" fill="#5c0a1e" stroke="#e11d48" stroke-width="1.5"/>
  <text x="517" y="136" fill="#fda4af" font-size="11" font-weight="bold" text-anchor="middle">Cowboy HTTP Handler</text>

  <!-- marthad_api_routes -->
  <rect x="425" y="155" width="185" height="28" rx="4" fill="#4c0519" stroke="#f43f5e" stroke-width="1"/>
  <text x="517" y="174" fill="#fecdd3" font-size="10" text-anchor="middle">marthad_api_routes.erl</text>

  <!-- Arrow from cowboy to routes -->
  <line x1="517" y1="147" x2="517" y2="155" stroke="#fb7185" stroke-width="1.5" marker-end="url(#arrow-rose)"/>

  <!-- CMD Domain Apps -->
  <text x="430" y="205" fill="#fda4af" font-size="10" font-weight="bold">CMD Department</text>
  <rect x="425" y="212" width="255" height="28" rx="3" fill="#3b0a1e" stroke="#f43f5e" stroke-width="1"/>
  <text x="552" y="231" fill="#fecdd3" font-size="10" text-anchor="middle">guide_venture_lifecycle (CMD)</text>
  <rect x="425" y="244" width="255" height="28" rx="3" fill="#3b0a1e" stroke="#f43f5e" stroke-width="1"/>
  <text x="552" y="263" fill="#fecdd3" font-size="10" text-anchor="middle">guide_division_alc (CMD)</text>

  <!-- Venture desks inside -->
  <text x="700" y="224" fill="#fb7185" font-size="8">initiate_venture, submit_vision,</text>
  <text x="700" y="236" fill="#fb7185" font-size="8">start_discovery, advance_storm,</text>
  <text x="700" y="248" fill="#fb7185" font-size="8">identify_division, promote_cluster...</text>

  <!-- Division desks -->
  <text x="700" y="264" fill="#fb7185" font-size="8">initiate_division, start_phase,</text>
  <text x="700" y="276" fill="#fb7185" font-size="8">design_event, plan_desk,</text>
  <text x="700" y="288" fill="#fb7185" font-size="8">generate_module, deploy_release...</text>

  <!-- QRY+PRJ Domain Apps -->
  <text x="430" y="308" fill="#fda4af" font-size="10" font-weight="bold">QRY+PRJ Department</text>
  <rect x="425" y="314" width="255" height="28" rx="3" fill="#3b0a1e" stroke="#fb923c" stroke-width="1"/>
  <text x="552" y="333" fill="#fed7aa" font-size="10" text-anchor="middle">query_venture_lifecycle (QRY+PRJ)</text>
  <rect x="425" y="346" width="255" height="28" rx="3" fill="#3b0a1e" stroke="#fb923c" stroke-width="1"/>
  <text x="552" y="365" fill="#fed7aa" font-size="10" text-anchor="middle">query_division_alc (QRY+PRJ)</text>

  <!-- Projection details -->
  <text x="700" y="333" fill="#fdba74" font-size="8">venture_initiated_v1_to_ventures,</text>
  <text x="700" y="345" fill="#fdba74" font-size="8">vision_submitted_v1_to_ventures,</text>
  <text x="700" y="357" fill="#fdba74" font-size="8">event_sticky_posted_v1_to_stickies...</text>
  <text x="700" y="369" fill="#fdba74" font-size="8">division_initiated_v1_to_divisions,</text>
  <text x="700" y="381" fill="#fdba74" font-size="8">phase_started_v1_to_divisions...</text>

  <!-- Arrow from routes to apps -->
  <line x1="517" y1="183" x2="517" y2="212" stroke="#fb7185" stroke-width="1.5" marker-end="url(#arrow-rose)"/>

  <!-- Event Store -->
  <rect x="425" y="395" width="255" height="40" rx="4" fill="#1a0a0e" stroke="#2dd4bf" stroke-width="1.5"/>
  <text x="552" y="412" fill="#5eead4" font-size="11" font-weight="bold" text-anchor="middle">martha_store</text>
  <text x="552" y="428" fill="#2dd4bf" font-size="9" text-anchor="middle">ReckonDB Event Store (local)</text>

  <!-- Arrow from apps to store -->
  <line x1="552" y1="374" x2="552" y2="395" stroke="#2dd4bf" stroke-width="1.5" marker-end="url(#arrow-teal)"/>

  <!-- SQLite Read Models -->
  <rect x="425" y="445" width="255" height="32" rx="4" fill="#1a0a0e" stroke="#fbbf24" stroke-width="1"/>
  <text x="552" y="466" fill="#fde68a" font-size="10" text-anchor="middle">SQLite Read Models (ventures, divisions, events...)</text>

  <!-- Arrow from QRY to SQLite -->
  <line x1="500" y1="374" x2="500" y2="445" stroke="#fbbf24" stroke-width="1" stroke-dasharray="4,2" marker-end="url(#arrow-amber)"/>

  <!-- API support modules -->
  <text x="430" y="498" fill="#94a3b8" font-size="9">marthad_api_utils.erl | marthad_health_api.erl</text>
  <text x="430" y="512" fill="#94a3b8" font-size="9">marthad_manifest_api.erl | marthad_paths.erl</text>
  <text x="430" y="526" fill="#94a3b8" font-size="9">marthad_projection_event.erl</text>

  <!-- Right side: Plugin registration -->
  <rect x="700" y="395" width="265" height="60" rx="4" fill="#1e1b3a" stroke="#818cf8" stroke-width="1"/>
  <text x="832" y="415" fill="#c7d2fe" font-size="10" font-weight="bold" text-anchor="middle">marthad_plugin_registrar.erl</text>
  <text x="832" y="430" fill="#818cf8" font-size="9" text-anchor="middle">Registers with hecate-daemon</text>
  <text x="832" y="445" fill="#818cf8" font-size="9" text-anchor="middle">on startup (socket path, manifest)</text>

  <!-- ========== BOTTOM: MESH PROXY + BEAM CLUSTER ========== -->
  <rect x="20" y="610" width="960" height="130" rx="6" fill="#0f172a" stroke="#a78bfa" stroke-width="1.5"/>
  <text x="40" y="635" fill="#c4b5fd" font-size="12" font-weight="bold">Cross-Daemon Communication</text>

  <!-- marthad_mesh_proxy -->
  <rect x="35" y="648" width="280" height="75" rx="4" fill="#1e1b3a" stroke="#a855f7" stroke-width="1.5"/>
  <text x="175" y="670" fill="#d8b4fe" font-size="11" font-weight="bold" text-anchor="middle">marthad_mesh_proxy.erl</text>
  <text x="175" y="688" fill="#a78bfa" font-size="9" text-anchor="middle">Proxies LLM requests and mesh</text>
  <text x="175" y="702" fill="#a78bfa" font-size="9" text-anchor="middle">operations via pg process groups</text>

  <!-- pg groups -->
  <rect x="345" y="648" width="160" height="75" rx="4" fill="#172554" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="425" y="670" fill="#93c5fd" font-size="11" font-weight="bold" text-anchor="middle">pg groups</text>
  <text x="425" y="688" fill="#60a5fa" font-size="9" text-anchor="middle">BEAM Distribution</text>
  <text x="425" y="702" fill="#60a5fa" font-size="9" text-anchor="middle">(erlang:send/2)</text>

  <!-- hecate-daemon -->
  <rect x="535" y="648" width="200" height="75" rx="4" fill="#172554" stroke="#3b82f6" stroke-width="2"/>
  <text x="635" y="670" fill="#93c5fd" font-size="12" font-weight="bold" text-anchor="middle">hecate-daemon</text>
  <text x="635" y="688" fill="#60a5fa" font-size="9" text-anchor="middle">LLM Proxy (serve_llm)</text>
  <text x="635" y="702" fill="#60a5fa" font-size="9" text-anchor="middle">Mesh Gateway (Macula/QUIC)</text>

  <!-- External -->
  <rect x="765" y="648" width="200" height="75" rx="4" fill="#1c1917" stroke="#78716c" stroke-width="1.5"/>
  <text x="865" y="670" fill="#d6d3d1" font-size="11" font-weight="bold" text-anchor="middle">External World</text>
  <text x="865" y="688" fill="#a8a29e" font-size="9" text-anchor="middle">Ollama / LLM providers</text>
  <text x="865" y="702" fill="#a8a29e" font-size="9" text-anchor="middle">Macula Mesh (WAN/QUIC)</text>

  <!-- Arrows: mesh proxy -> pg -> daemon -> external -->
  <line x1="315" y1="685" x2="345" y2="685" stroke="#a78bfa" stroke-width="2" marker-end="url(#arrow-purple)"/>
  <line x1="505" y1="685" x2="535" y2="685" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrow-indigo)"/>
  <line x1="735" y1="685" x2="765" y2="685" stroke="#78716c" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- ========== BOTTOM: SOCKET DISCOVERY NOTE ========== -->
  <rect x="20" y="755" width="960" height="50" rx="4" fill="#1e1e2e" stroke="#475569" stroke-width="1"/>
  <text x="40" y="775" fill="#94a3b8" font-size="10" font-weight="bold">Socket Discovery</text>
  <text x="40" y="793" fill="#64748b" font-size="10">hecate-web discovers Martha at: ~/.hecate/hecate-marthad/sockets/api.sock (bind-mounted into daemon container)</text>

  <!-- Connection line: daemon column to mesh proxy -->
  <line x1="695" y1="595" x2="175" y2="648" stroke="#a78bfa" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrow-purple)"/>

</svg>